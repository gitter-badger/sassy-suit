// https://medium.com/@marcmintel/validating-parameters-in-sass-a0cac60c6222

// http://sassmeister.com/gist/651f96b598540f7ca20b - debugging

/**
 * Tests whether `$var` is bool.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for bool type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_bool(true)    //returns true
 *  is_bool(false)   //returns true
 *  is_bool(test)    //returns false
 *  is_bool(1)       //returns false
 *  is_bool(null)    //returns false
 */

@function is_bool($var) {
	@if type-of($var) == bool {
		@return true;
	} @else {
		@return false;
	}
}

/**
 * Tests whether `$var` is color.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for color type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_color(#333)   //returns true
 *  is_color(black)  //returns true
 *  is_color(test)   //returns false
 */

@function is_color($var) {
	@if type-of($var) == color {
		@return true;
	} @else {
		@return false;
	}
}

/**
 * Tests whether `$var` is bool.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for bool type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_null(null)  //returns true
 *  is_null(false) //returns false
 *  is_null(0) //returns false
 *  is_null('hello') //returns false
 *  is_null(113) //returns false
 */

@function is_null($var) {
	@if $var == null {
		@return true;
	} @else {
		@return false;
	}
}

/**
 * Tests whether `$var` is empty.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for emptiness
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_empty('')     //returns true
 *  is_empty(())     //returns true
 *  is_empty('test') //returns false
 */

@function is_empty($var) {
	@if type-of($var) == string {
		@return str-length($var) == 0;
	}
	@if type-of($var) == number {
		@return $var != 0;
	}
	@if type-of($var) == list {
		@return length($var) == 0;
	}
	@if $var == false {
		@return true;
	}
	@if $var == null {
		@return true;
	}
}

/**
 * Tests whether `$var` is list.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for list type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_list(a b)          //returns true
 *  is_list(1 2 3)        //returns true
 *  is_list((test, test)) //returns true
 *  is_list(test)         //returns false
 *  is_list(1)            //returns false
 */

@function is_list($var) {
	@if type-of($var) == list {
		@return true;
	}
	@else {
		@return false;
	}
}

/**
 * Tests whether `$var` is measure.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for measure type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_measure(1px)   //returns true
 *  is_measure(5em)   //returns true
 *  is_measure(5)     //returns false
 *  is_measure(test)  //returns false
 *  is_measure(em)    //returns false
 */

@function is_measure($var) {
	@if type-of($var) == number {
		@if unitless($var) {
			@return false;
		}
	}
	@else {
		@return false;
	}
	@if not index($UNITS, unit($var)) {
		@return false;
	}
	@else {
		@return true;
	}
}

/**
 * Tests whether `$var` is number.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for number type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_number(1)   //returns true
 *  is_number('1') //returns false
 *  is_number(1em) //returns false
 */

@function is_number($var) {
	@if type-of($var) == number {
		@return unitless($var);
	}
	@else {
		@return false;
	}
}

/**
 * Tests whether `$var` is string.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @param {*} $var  - check for string type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_string(test) //returns true
 *  is_string(1)    //returns false
 */

@function is_string($var) {
	@if type-of($var) != string {
		@return false;
	} @else {
		@return true;
	}
}

/**
 * Tests whether `$var` is unit.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @requires invoke
 * ---
 * @param {*} $value  - string or list to test
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_unit(1.618rem) //returns true
 *  is_unit(-1000px) //returns true
 *  is_unit('test') //returns false
 *  is_unit(777) //returns false
 */

@function is_unit($var) {
	@if type-of($var) == string {
		@return if(index($UNITS, $var), true, false);
	} @else {
		@return false;
	}
}

/**
 * Tests whether `$var` is integer.
 * ---
 * @access public
 * ---
 * @group checks
 * ---
 * @since 1.0.0
 * ---
 * @requires is-number
 * ---
 * @param {literal} $var  - check for integer type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is-integer(1)   //returns true
 * @example
 *  is-integer(0) //returns true
 * @example
 *  is-integer(-50) //returns true
 * @example
 *  is-integer(1.5) //returns false
 * @example
 *  is-integer(1em) //returns false
 */

@function is-integer($var) {
    @if not is-number($var) {
        @return false;
    }
    @if round($var) != $var {
        @return false;
    }
    @return true;
}

/**
 * Tests whether `$var` is float.
 * ---
 * @access public
 * ---
 * @group checks
 * ---
 * @since 1.0.0
 * ---
 * @requires is-number
 * @requires is-integer
 * ---
 * @param {literal} $var  - check for float type
 * ---
 * @return {bool}
 * ---
 * @example
 *  is-float(-1.5) //returns true
 * @example
 *  is-float(1.5) //returns true
 * @example
 *  is-float(1)   //returns false
 * @example
 *  is-float(1em) //returns false
 * @example
 *  is-float(0) //returns false
 */

@function is-float($var) {
    @if $var == 0 {
        @return false;
    }
    @if not is-number($var) {
        @return false;
    }
    @if not is-integer($var) {
        @return true;
    }
    @return false;
}

/**
 * Tests whether `$var` is negative.
 * ---
 * @access public
 * ---
 * @since 1.0.0
 * ---
 * @requires measure
 * ---
 * @param {*} $value  - check for negative values
 * ---
 * @return {bool}
 * ---
 * @example
 *  is_negative(-5) //returns true
 *  is_negative(-10px) //returns false
 *  is_negative(300) //returns false
 *  is_negative('test') //returns false
 *  is_negative(0) //returns false
 */

@function is_negative($var) {
	@if (type-of($var) == number) and $var < 0 == true {
		@return true;
	} @else if (type-of($var) == number) and $var == 0 {
		@warn "Number is not negative! Number equals zero";
		@return false;
	}
	@else {
		@return false;
	}
}

/**
 * Tests whether `$var` is positive.
 * ---
 * @access public
 * ---
 * @group checks
 * ---
 * @since 1.0.0
 * ---
 * @requires is-number
 * ---
 * @param {literal} $var  - check whether $var is positive
 * ---
 * @return {bool}
 * ---
 * @example
 *  is-positive(1)   //returns true
 * @example
 *  is-positive(0)   //returns false
 * @example
 *  is-positive(-1)   //returns false
 */

@function is-positive($var) {
    @if is-number($var) and $var > 0 == true {
        @return true;
    } @else if $var == 0 {
		@warn "Number is not positive! Number equals zero";
		@return false;
    } @else {
        @return false;
    }
}

/**
 * Tests whether `$var` is a measure and has a positive value.
 * ---
 * @access public
 * ---
 * @group checks
 * ---
 * @since 1.0.0
 * ---
 * @requires is-number
 * @requires is-measure
 * @requires is-positive
 * ---
 * @param {literal} $var  - check whether $var is a positive measure
 * ---
 * @return {bool}
 * ---
 * @example
 *  is-measurePositive(10px)   //returns true
 * @example
 *  is-measurePositive(0px)   //returns false
 * @example
 *  is-measurePositive(0)   //returns false
 * @example
 *  is-measurePositive(-777px)   //returns false
 */

@function is-measurePositive($var) {
	@if is-measure($var) and $var > 0 {
		@return true;
	} @else if is-measure($var) and $var == 0 {
		@warn "Using zero value with units is a lame idea";
		@return false;
	} @else {
		@return false;
	}
}

/**
 * Tests whether `$var` is a measure and has a negative value.
 * ---
 * @access public
 * ---
 * @group checks
 * ---
 * @since 1.0.0
 * ---
 * @requires is-number
 * @requires is-measure
 * @requires is-negative
 * ---
 * @param {literal} $var  - check whether $var is a positive measure
 * ---
 * @return {bool}
 * ---
 * @example
 *  is-measureNegative(-10em)   //returns true
 * @example
 *  is-measureNegative(0px)   //returns false
 * @example
 *  is-measureNegative(0)   //returns false
 * @example
 *  is-measureNegative(777rem)   //returns false
 */

@function is-measureNegative($var) {
	@if is-measure($var) and $var < 0 {
		@return true;
	} @else if is-measure($var) and $var == 0 {
		@warn "Using zero value with units is a lame idea";
		@return false;
	} @else {
		@return false;
	}
}

/**
 * validates input against various tests
 * ---
 * @requires is_bool
 * @requires is_color
 * @requires is_empty
 * @requires is_list
 * @requires is_measure
 * @requires is_null
 * @requires is_number
 * @requires is_string
 * @requires is_unit
 * @requires is_negative
 * @requires is_positive
 * @requires is_integer
 * @requires is_float
 * @requires is_measurePositive
 * @requires is_measureNegative
 * ---
 * @param {value}Â           $var         - a variable to be tested
 * @param {list|string|any}Â $validations - the validations to test (e.g. measure, string, number, unit). "any" means it can be any type so there won't be any kind of test.
 * ---
 * @return {bool}
 * ---
 * @throws '$var is not a known validation type.'
 * ---
 * @example
 *  validate(1em, measure)     //returns 1em
 *  validate(em, unit string)  //returns em
 *  validate(1, number string) //returns 1
 *  validate(1, number)        //returns 1
 *  validate(1, string)        //returns false
 * ---
 * @since 1.0.0
 */

@function validate($var, $validations) {
	//set a list of testable validation types
	$allTypes: measure, list, bool, string, color, number, unit, negative, positive, integer, float, measurePositive, measureNegative;

	//do not test anything if type equals "any"
	@if $validations == any {
		@return true;
	}

	//if there is more than one validation test
	@if length($validations) > 1 {
		//break function if validation is not a known data type
		@each $validation in $validations {
			@if not index($allTypes, $validation) {
				@warn '#{$validation} is not a known validation type.';
				@return false;
			}
		}
	}

	//collect validation errors
	$errors: ();
	//check each validation and set 1 for each failure
	@each $validation in $validations {
		@if $validation == measure {
			@if not is_measure($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == list {
			@if not is_list($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == color {
			@if not is_color($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == bool {
			@if not is_bool($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == null {
			@if not is_null($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == string {
			@if not is_string($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == number {
			@if not is_number($var) {
				$errors: append($errors, 1);
			}
		}

		@else if $validation == unit {
			@if not is_unit($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == integer {
			@if not is_integer($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == float {
			@if not is_float($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == negative {
			@if not is_negative($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == positive {
			@if not is_positive($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == measureNegative {
			@if not is_measureNegative($var) {
				$errors: append($errors, 1);
			}
		}
		@else if $validation == measurePositive {
			@if not is_measurePositive($var) {
				$errors: append($errors, 1);
			}
		}

		//as we checked earlier $validation must be one of our data types
		//so this condition my never be encountered but just in case..return false
		@else {
			@return false;
		}
	}

	//throw an error if there are as many validation errors as validation tests because all checked types failed
	@if length($errors) >= length($validations) {
		@return false;
	}
	//at least one of tested types must be valid
	@else {
		@return true;
	}
}
